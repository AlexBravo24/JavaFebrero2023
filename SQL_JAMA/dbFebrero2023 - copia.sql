x-- con dos guinos puedo poner un comentario

/* Ponemos poner comentarios de multiples lineas
SQL - Lenguaje de consulta estructuradac (structured query languege)
Es un lenguaje para actualizar, obtener y calcular informacion en
base de datos relacionales

Base de Datos - Conjunto de datos organizados y relacionados
y que son almacenados en tablas

*/

/*La estructura de las tablas queda de la siguiente manera

- Toda tabla debe de llevar una llave primaria
(ID o un numero que identifique cada registro de la misma)
- Pueden llevar tambien llaves Foraneas.
-Una llave foranea es la llave prinaria que proviene de otra tabla
-Tipo de dato - pueden ser numericos, caracteres, tipo fecha, etc.

Caracter - Char, Varchar, Varchar2, Nchar, NVARCHAR2
Numericos - Long, int, NUMBER,

*/

-- Crear una tabla de ejemplo
-- ALMACENAR LOS DATOS DE UNA PERSONA

-- ID DE LA PERSONA
-- NOMBRE
-- EDAD
-- SEXO


-- CREANDO LA TABLA PARA PERSONA
-- LA SINTAXIS PARA CREAR LA TABLA ES LA SIGUIENTE:
-- CREATE TABLE NOMBRE DE LA TABLA (
-- Nombredecampo1 tipodedato,
--.......
--nombredecampofinal yipodedato
--);
-- SELECIONAMOS LA SENTENCIA Y DAMOS CTRL + ENTER
CREATE TABLE PERSONA(
INE NUMBER PRIMARY KEY,
NOMBRE NVARCHAR2(20),
EDAD NUMBER,
SEXO NVARCHAR2(1)
);

-- PARA VE LA ESTRUCTURA DE UNA TABLA UTILZAMOS LA SIGUIENTE SENTENCIA
DESCRIBE PERSONA;

-- HAY QUE ESTABLECER VALORES QUE NO VAMBIEN, COMO EN ESTE CASO
-- LA EDAD.
-- LO IDEAL SERIA CAMBIAR EL TIPO DE DATO POR DATE

-- ELIMINAR UNA TABLA
DROP TABLE PERSONA;


-- CRAR UNA TABLA ALUMNO
-- MATRICULA
-- NOMBRE
-- FECHA DE NACIMIENTO
-- SEXO
-- SEMESTRE
-- status si es alumno activo escorlarmente

CREATE TABLE ALUMNOS(
ID_ALUMNO NUMBER PRIMARY KEY,
NOMBRE NVARCHAR2 (30),
FECHANAC DATE,
SEXO NVARCHAR2 (20),
SEMESTRE NVARCHAR2 (30),
STATUS NUMBER
);

CREATE TABLE CARRERAS(
ID_CARRERA NUMBER PRIMARY KEY,
NOMBRE NVARCHAR2(30),
DURACIONSEM NUMBER,
AREA NVARCHAR2 (30),
CREDITOS NUMBER
);

-- ENTIDADES FUERTES - NO DEPENDEN DE OTRAS PARA EXISTIR (TIENEN
-- SUS DATOS COMPLETOS)
-- ENTIDADES DEBILES - DEPENDEN DE PTRA TABLA U OTROS DATOS
-- PARA EXISTIR. SE IDENTIFICAN FACILMENTE POR QUE RECIBEN UNA LLAVE
-- FORANEA

-- CREAMOS UNA TABLE QUE NOS PERMITA RELACIONAR A LOS ALUMNOS 
-- ON SUS RESPECTIVAS CARRERAS

CREATE TABLE CARRERAS_ALUMNOS(
ID_CA NUMBER PRIMARY KEY,
ID_CARRERA NUMBER,
ID_ALUMNO NUMBER
);

-- AGREGANDO RSTRICCIONES A UNA TABLA

-- Las restricciones deben llevar un nombre y se identifican 
-- por la palabra 'constraint'

-- como ejemplo vamos a agregar una restriccion en el sexo en la
-- tabla para que solo podamos introducir ''masculino' o 'femenino'

ALTER TABLE ALUMNO ADD CONSTRAINT CHECK_SEXO
CHECK (SEXO IN ('MASCULINO','FEMENINO'));

DESCRIBE ALUMNO;

-- PARA GUARDAR EL SCRIPT
-- UTILIZAN CTRL + S

-- BORRAR O ELIMINAR UNA RESTRCCION EN UNA TABLA
ALTER TABLE ALUMNO DROP CONSTRAINT CHECK_SEXO;

-- UNIQUE SE UTILIZA PARA AGREGAR UNA RESTRICCION A UN REGISTRO 

ALTER TABLE CARRERAS ADD CONSTRAINT INQ_NOMBRE_CARRERA
UNIQUE (NOMBRE)

-- AGREGANDO UNA LLAVE FORANEA
-- UNA LLAVE FORANEA TAMBIEN ES UNA RESTRICCION, POR
-- VAMOS A ESPECIFICAR DE DONDE PROVIENE DICHA LLAVE

-- SINTAXIS GENERAL

-- ALETER TABLE NOMBRE DE LA TABLA ADD CONSTRAINT NOMBREDELARESTRICCION
-- FORIGNKEY (COLUMNA QUE RECIBE)
--REFERENCES NOMBREDELATABLA (COLUMNA CON LLAVE PRIMARIA); -- QUIEN DA

ALTER TABLE CARRERAS_ALUMNOS ADD CONSTRAINT FK_ID_ALUMNO
FOREIGN KEY (ID_ALUMNO)
REFERENCES ALUMNO (ID_ALUMNO);

ALTER TABLE CARRERAS_ALUMNOS ADD CONSTRAINT FK_ID_CARRERA
FOREIGN KEY (ID_CARRERA)
REFERENCES CARRERAS (ID_CARRERA);

DESCRIBE CARRERAS;

-- AGREGAR UNA COLUMNA A UNA TABLA EXITENTE

ALTER TABLE CARRERAS ADD PRESUPUESTO NUMBER;

-- ELIMINAR UNA COLUMNA DE UNA TABLA
ALTER TABLE CARRERAS DROP COLUMN PRESUPUESTO;

-- PODEMOS INDICAR EL USO DE DECIMALES. INDICANDO LA LONGITUD NUMERICA
--Y SEPARAMOS CON UNA COMA, CUANTAS POSICIONES SERIAN LOS DECIMALES
--QUEDANDO EN EL EJEMPLO UN VALOR MAXIMO ENTERO DE  9999 Y 
-- UN DECIMAL DE .99
ALTER TABLE CARRERAS ADD PRESUPUESTO NUMBER(6,2);

-- RENOMBRAR UNA COLUMNA

ALTER TABLE CARRERAS RENAME COLUMN PRESUPUESTO TO PRESUPUESTO_MENSUAL;


ALTER TABLE CARRERAS MODIFY PRESUPUESTO_MENSUAL NVARCHAR2(10);

ALTER TABLE CARRERAS MODIFY PRESUPUESTO_MENSUAL NUMBER(6,2);

-- INSERCION DE DATOS INDIVIDUALES

DESCRIBE ALUMNO;

INSERT INTO ALUMNO VALUES
(1,'EDUARDO','13/10/1990','MASCULINO','9o SEMESTRE',1);
INSERT INTO ALUMNO VALUES
(2,'STEPHANY','23/10/1997','FEMENINO','8o SEMESTRE',1);
INSERT INTO ALUMNO VALUES
(3,'JUAN','10/10/1997','MASCULINO','9o SEMESTRE',1);
INSERT INTO ALUMNO VALUES
(4,'JOSE LUIS','04/01/1998','MASCULINO','9o SEMESTRE',1);
INSERT INTO ALUMNO VALUES
(5,'GABRIELA','13/10/1990','MASCULINO','9o SEMESTRE',1);

---------------------------------------------------------

-- rEALIZAMOS UNA CONSULTA GENERA DE LOS DATOS INGRESADOS
-- EN UNA TABLE

SELECT * FROM ALUMNO;

-- PARA CONFIRMAR DE LOS REGISTROS QUE INSERTAMOS
-- (GUARDAR)

COMMIT;

-- BORRAR UN REGISTRO ESPECIFICO UN CAMPO A COINCIDIR
-- CON EL REGISTRO

DELETE FROM ALUMNO WHERE ID_ALUMNO=4;

-- insercion de datos en la tabla carreras

INSERT INTO CARRERAS VALUES
(1,'ING EN SITEMAS',8,'EXACTAS',400,9000);
INSERT INTO CARRERAS VALUES
(2,'MEDICINA',8,'BIOLOGICOS',400,9000);
INSERT INTO CARRERAS VALUES
(3,'NUTRICION',8,'BIOLOGICOS',400,9000);
INSERT INTO CARRERAS VALUES
(4,'MERCADOTECNIA',8,'ADMINISTRATIVA',400,9000);
INSERT INTO CARRERAS VALUES
(5,'DERECHO',8,'HUMANIDADES',400,9000);

SELECT * FROM CARRERAS;

COMMIT;

-- DESCRIBE DATOS EN NUESTRA TABLA RELACIONAL

DESCRIBE CARRERAS_ALUMNOS;

INSERT INTO CARRERAS_ALUMNOS VALUES (1,1,2);
INSERT INTO CARRERAS_ALUMNOS VALUES (2,2,1);
INSERT INTO CARRERAS_ALUMNOS VALUES (3,3,5);
INSERT INTO CARRERAS_ALUMNOS VALUES (4,5,3);
INSERT INTO CARRERAS_ALUMNOS VALUES (5,5,3);


SELECT * FROM ALUMNO;
SELECT * FROM CARRERAS;
SELECT * FROM CARRERAS_ALUMNOS;

--EJERCICIO
-- CREAR UNA TABLA LLAMADA TUTORES
--ID_DE_TUTOR NOMBRE, SEXO, TELEFONO, CLAVE_DE_TUTOR
-- RESTRICCION EN LA CLAVE DEL TUTOR (A,B,C,D)
--INSERTAR 5 REGISTROS

-- CREAR UNA TABLA RELACIONAL ALUMNO_TUTORES
-- ID DE LA TABLA
--ID_ALUMNO (LLAVE FORANEA)
-- ID_TUTOR (LLAVE FORANEA)
--  INSERTAR 5 REGISTROS

CREATE TABLE TUTORES(
ID_TUTORES NUMBER PRIMARY KEY,
NOMBRE NVARCHAR2 (30),
SEXO NVARCHAR2 (20),
TELEFONO NVARCHAR2 (30),
CLAVE_DE_TUTOR NUMBER
);

ALTER TABLE TUTORES MODIFY CLAVE_DE_TUTOR NVARCHAR2(1);

ALTER TABLE TUTORES ADD CONSTRAINT CHECK_SEXO
CHECK (SEXO IN ('MASCULINO','FEMENINO'));

ALTER TABLE TUTORES ADD CONSTRAINT CHECK_CLAVE_DE_TUTOR
CHECK (CLAVE_DE_TUTOR IN ('A','B','C','D'));

INSERT INTO TUTORES VALUES (1,'ROLANDO','MASCULINO','22222222','A');
INSERT INTO TUTORES VALUES (2,'ANA','FEMENINO','22222222','B');
INSERT INTO TUTORES VALUES (3,'LOLA','FEMENINO','22222222','B');
INSERT INTO TUTORES VALUES (4,'PEDRO','MASCULINO','22222222','C');
INSERT INTO TUTORES VALUES (5,'IGNACIO','MASCULINO','22222222','D');

COMMIT;

SELECT * FROM TUTORES;

CREATE TABLE TUTORES_ALUMNOS(
ID_TA NUMBER PRIMARY KEY,
ID_TUTORES NUMBER,
ID_ALUMNO NUMBER
);

DESCRIBE TUTORES_ALUMNOS;

ALTER TABLE TUTORES_ALUMNOS ADD CONSTRAINT FK_IDALUMNO
FOREIGN KEY (ID_ALUMNO)
REFERENCES ALUMNO (ID_ALUMNO)
;

ALTER TABLE TUTORES_ALUMNOS ADD CONSTRAINT FK_IDTUTORES
FOREIGN KEY (ID_TUTORES)
REFERENCES TUTORES (ID_TUTORES)
;

INSERT INTO TUTORES_ALUMNOS VALUES (1,1,2);
INSERT INTO TUTORES_ALUMNOS VALUES (2,2,1);
INSERT INTO TUTORES_ALUMNOS VALUES (3,3,5);
INSERT INTO TUTORES_ALUMNOS VALUES (4,5,1);
INSERT INTO TUTORES_ALUMNOS VALUES (5,5,1);

SELECT * FROM TUTORES_ALUMNOS;

COMMIT;

-- ENPLEAR SECUENCIAS
-- CREAR SECUENCIAS
-- SE EMPLEAN PARA GENERAR VALORES DE NUMEROS ENTEROS
-- PUEDEN SER CONSECUTIVOS
-- O CON UN INCREMENTO AUTOMATICAMENTE UNA SECUENCIA EN LOS VALORES
-- DE LAS LLAVES PRIMARIAS
-- Y ASI ASEGURARNOS QUE LOS VALORES NO SE REPITAN

-- CREANDO UNA SECUENCIA DEFINIENDO LOS VALORES
CREATE SEQUENCE ALUMNO_SEQ -- CREAR LA SECUENCIA Y SU NOMBRE
START WITH 6 -- INDICAMOS EL VALOR EN EL QUE INICIA LA SECUENCIA
INCREMENT BY 1 -- INCREMENTAMOS EL VALOR DE LA SECUENCIA COMO SE LE INDIQUE
MAXVALUE 9999 --INDICAMOS EL VALOR MAXIMO DE LA SECUENCIA
MINVALUE 1 -- INDICAMOS EL VALOR MINIMO DE LA SECUENCIA
CYCLE; -- INDICA SI LA SECUENCIA SE REPITE O NO (NOCYCLE)


-- TIRGGER (DISPARADOR)
-- EJECUTAR O DESENCADENAR UNA ACCION

CREATE TRIGGER INSERT_ALUMNO -- CREAMOS EL TRIGGER Y SU NOMBRE
BEFORE INSERT ON ALUMNO FOR EACH ROW BEGIN -- DONDE SE EJECUTA EL TRIGGER
SELECT ALUMNO_SEQ.NEXTVAL INTO:NEW.ID_ALUMNO  FROM DUAL; --SELECCIONA EL VALOR DE LA SECIENCIA Y LO INSERTA
END;

-- ELIMINAR UN TRIGGER
DROP TRIGGER INSERT_ALUMNO;

INSERT INTO ALUMNO VALUES
(1,'GERARDO','14/03/1990','MASCULINO','8o SEMESTRE',1);

SELECT * FROM ALUMNO;

SELECT * FROM TUTORES_ALUMNOS;

DROP TABLE TUTORES_ALUMNOS;

CREATE SEQUENCE TUTORES_ALUMNOS_SEQ;

CREATE TRIGGER INSERT_TUTORES_ALUMNOS -- CREAMOS EL TRIGGER Y SU NOMBRE
BEFORE INSERT ON TUTORES_ALUMNOS FOR EACH ROW BEGIN -- DONDE SE EJECUTA EL TRIGGER
SELECT TUTORES_ALUMNOS_SEQ.NEXTVAL INTO:NEW.ID_TA  FROM DUAL; --SELECCIONA EL VALOR DE LA SECIENCIA Y LO INSERTA
END;

DROP TRIGGER INSERT_TUTORES_ALUMNOS;

INSERT INTO TUTORES_ALUMNOS (ID_ALUMNO, ID_TUTORES) VALUES (1,2);
INSERT INTO TUTORES_ALUMNOS (ID_ALUMNO, ID_TUTORES) VALUES (2,3);

-- OTRA FORMA DE INSERCION "MASIVA"

INSERT ALL
INTO ALUMNO(NOMBRE,FECHANAC,SEXO,SEMESTRE,STATUS)VALUES
('EDUARDOS','13/10/1990','MASCULINO','9o SEMESTRE',1)
INTO ALUMNO(NOMBRE,FECHANAC,SEXO,SEMESTRE,STATUS)VALUES
('STEPHANYS','23/10/1997','FEMENINO','8o SEMESTRE',1)
INTO ALUMNO(NOMBRE,FECHANAC,SEXO,SEMESTRE,STATUS)VALUES
('JUAN','10/10/1997','MASCULINO','9o SEMESTRE',1)
INTO ALUMNO(NOMBRE,FECHANAC,SEXO,SEMESTRE,STATUS)VALUES
('JOSE LUISS','04/01/1998','MASCULINO','9o SEMESTRE',1)
INTO ALUMNO(NOMBRE,FECHANAC,SEXO,SEMESTRE,STATUS)VALUES
('GABRIELASS','13/10/1990','MASCULINO','9o SEMESTRE',1)
SELECT * FROM DUAL;

SELECT * FROM ALUMNO;

INSERT INTO ALUMNO VALUES
(1, 'YOLANDO', '14/03/1990', 'MASCULINO', '8o SEMESTRE',1);

-----------------------------------------------------------

-- EJERCICIO 1 ASUNTO Y PROCURADORES

CREATE TABLE ASUNTOS(
NUM_EXPEDIENTE NUMBER PRIMARY KEY,
FECHA_INI DATE,
FECHA_FIN NVARCHAR2(15),
ESTADO NVARCHAR2(15)
);

CREATE SEQUENCE ASUNTO_SEQ;

CREATE TRIGGER INSERT_ASUNTO 
BEFORE INSERT ON ASUNTOS FOR EACH ROW BEGIN 
SELECT ASUNTO_SEQ.NEXTVAL INTO:NEW.NUM_EXPEDIENTE  FROM DUAL; 
END;

INSERT ALL
INTO ASUNTO(FECHAINI,FECHAFIN,ESTADO)VALUES
('13/10/1990','13/10/1992','ARCHIVADO')
INTO ASUNTO(FECHAINI,FECHAFIN,ESTADO)VALUES
('27/02/2023','SIN FINALIZAR','EN TRAMITE')
INTO ASUNTO(FECHAINI,FECHAFIN,ESTADO)VALUES
('05/02/2023','SIN FINALIZAR','EN TRAMITE')
INTO ASUNTO(FECHAINI,FECHAFIN,ESTADO)VALUES
('13/10/1990','13/10/2002','ARCHIVADO')
INTO ASUNTO(FECHAINI,FECHAFIN,ESTADO)VALUES
('13/09/2010','13/10/2010','ARCHIVADO')
SELECT * FROM DUAL;

CREATE TABLE CLIENTES (
ID_CLIENTE NUMBER PRIMARY KEY,
NOMBRE NVARCHAR2 (30),
DIRECCION NVARCHAR2(15),
SEXO NVARCHAR2(15)
);

CREATE SEQUENCE CLIENTES_SEQ;

CREATE TRIGGER INSERT_CLIENTES 
BEFORE INSERT ON TUTORES_ALUMNOS FOR EACH ROW BEGIN 
SELECT CLIENTES_SEQ.NEXTVAL INTO:NEW.ID_CLIENTE  FROM DUAL; 
END;

INSERT ALL
INTO CLIENTES(NOMBRE,DIRECCION,SEXO)VALUES
('HELENA','MEXICO','FEMENINO')
INTO CLIENTES(NOMBRE,DIRECCION,SEXO)VALUES
('AQUILES','MEXICO','MASCULINO')
INTO CLIENTES(NOMBRE,DIRECCION,SEXO)VALUES
('HECTOR','MEXICO','MASCULINO')
INTO CLIENTES(NOMBRE,DIRECCION,SEXO)VALUES
('PARIS','MEXICO','MASCULINO')
INTO CLIENTES(NOMBRE,DIRECCION,SEXO)VALUES
('LEONIDAS','MEXICO','MASCULINO')
SELECT * FROM DUAL;


CREATE TABLE PROCURADORES (
ID_PROCURADOR NUMBER PRIMARY KEY,
NOMBRE NVARCHAR2 (30),
DIRECCION NVARCHAR2(15),
SEXO NVARCHAR2 (20),
);

CREATE SEQUENCE PROCURADORES_SEQ;

CREATE TRIGGER INSERT_PROCURADORES 
BEFORE INSERT ON TUTORES_ALUMNOS FOR EACH ROW BEGIN
SELECT PROCURADORES_SEQ.NEXTVAL INTO:NEW.ID_PROCURADORES  FROM DUAL; 
END;

INSERT ALL
INTO PROCURADORES(NOMBRE,DIRECCION,SEXO)VALUES
('JOE','MEXICO','FEMENINO')
INTO PROCURADORES(NOMBRE,DIRECCION,SEXO)VALUES
('Tyler_Durden','OAXACA','MASCULINO')
INTO PROCURADORES(NOMBRE,DIRECCION,SEXO)VALUES
('Louis_de_Pointe_du_Lac','MONTERREY','MASCULINO')
INTO PROCURADORES(NOMBRE,DIRECCION,SEXO)VALUES
('Rusty_Ryan','PUEBLA','MASCULINO')
INTO PROCURADORES(NOMBRE,DIRECCION,SEXO)VALUES
('Jane Smith','GUADALAJARA','FEMENINO')
SELECT * FROM DUAL;

CREATE TABLE CASOS (
ID_CASOS NUMBER PRIMARY KEY,
NUM_EXPEDIENTE NUMBER,
ID_CLIENTE NUMBER,
ID_PROCURADOR NUMBER,
CONSTRAINT FK_NUMEXPEDIENTE
FOREIGN KEY (NUM_EXPEDIENTE)
REFERENCE ASUNTO (NUM_EXPEDIENTE)
CONSTRAINT FK_IDCLIENTE
FOREIGN KEY (ID_CLIENTE)
REFERENCE CLIENTES (ID_CLIENTE)
CONSTRAINT FK_IDPROCURADOR
FOREIGN KEY (ID_PROCURADOR)
REFERENCE PROCURADORES (ID_PROCURADOR)
);

CREATE SEQUENCE CASOS_SEQ;

CREATE TRIGGER INSERT_CASOS 
BEFORE INSERT ON CASOS FOR EACH ROW BEGIN
SELECT CASOS_SEQ.NEXTVAL INTO:NEW.ID_CASOS  FROM DUAL; 
END;

INSERT INTO TUTORES_ALUMNOS (NUM_EXPEDIENTE, ID_CLIENTE,ID_PROCURADOR);
INSERT INTO TUTORES_ALUMNOS (NUM_EXPEDIENTE, ID_CLIENTE,ID_PROCURADOR);


------------------------------------------------------------------
-- EJERCICIO 3

-- EJERCICIO 3

--ENTIDAD FUERTE
CREATE TABLE SOCIO(
ID_SOCIO NUMBER PRIMARY KEY,
NOMBRE NVARCHAR2(30),
DIRECCION NVARCHAR2 (30),
TELEFONO NVARCHAR2(10)
);

CREATE SEQUENCE SOCIO_SEQ;

CREATE TRIGGER INSERT_SOCIO
BEFORE INSERT ON SOCIO FOR EACH ROW BEGIN
SELECT SOCIO_SEQ.NEXTVAL INTO:NEW.ID_SOCIO FROM DUAL;
END;

--ENTIDAD FUERTE
CREATE TABLE BARCO(
ID_BARCO NUMBER PRIMARY KEY,
NOMBRE NVARCHAR2(30),
NUM_AMARRE NUMBER,
CUOTA NUMBER (6,2)
);

CREATE SEQUENCE BARCO_SEQ;

CREATE TRIGGER INSERT_BARCO
BEFORE INSERT ON BARCO FOR EACH ROW BEGIN
SELECT BARCO_SEQ.NEXTVAL INTO:NEW.ID_BARCO FROM DUAL;
END;

-- ENTIDAD FUERTE
CREATE TABLE PATRON(
ID_PATRON NUMBER PRIMARY KEY,
NOMBRE NVARCHAR2(30),
DIRECCION NVARCHAR2 (30),
TELEFONO NVARCHAR2(10)
);

CREATE SEQUENCE PATRON_SEQ;

CREATE TRIGGER INSERT_PATRON
BEFORE INSERT ON PATRON FOR EACH ROW BEGIN
SELECT PATRON_SEQ.NEXTVAL INTO:NEW.ID_PATRON FROM DUAL;
END;


-- ENTIDAD DEBIL
CREATE TABLE SOCIOS_BARCO(
ID_SB NUMBER PRIMARY KEY,
ID_SOCIO NUMBER,
ID_BARCO NUMBER,
CONSTRAINT FK_ID_SOCIO
FOREIGN KEY (ID_SOCIO)
REFERENCES SOCIO (ID_SOCIO),
CONSTRAINT FK_ID_BARCO
FOREIGN KEY (ID_BARCO)
REFERENCES BARCO (ID_BARCO)
);

CREATE SEQUENCE SOCIOSBARCO_SEQ;

CREATE TRIGGER INSERT_SOCIOSBARCO
BEFORE INSERT ON SOCIOS_BARCO FOR EACH ROW BEGIN
SELECT SOCIOSBARCO_SEQ.NEXTVAL INTO:NEW.ID_SB FROM DUAL;
END;

-- ENTIDAD DEBIL
CREATE TABLE SALIDAS_BARCO(
ID_SALIDA NUMBER PRIMARY KEY,
DESTINO NVARCHAR2(30),
FECHASALIDA DATE,
ID_BARCO NUMBER,
ID_PATRON NUMBER,
CONSTRAINT FK_IDBARCO
FOREIGN KEY (ID_BARCO)
REFERENCES BARCO (ID_BARCO),
CONSTRAINT FK_IDPATRON
FOREIGN KEY (ID_PATRON)
REFERENCES PATRON (ID_PATRON)
);

CREATE SEQUENCE SALIDASBARCO_SEQ;

CREATE TRIGGER INSERT_SALIDASBARCO
BEFORE INSERT ON SALIDAS_BARCO FOR EACH ROW BEGIN
SELECT SALIDASBARCO_SEQ.NEXTVAL INTO:NEW.ID_SALIDA FROM DUAL;
END;

--INSERCION DE DATOS PRIMERAMENTE EN ENTIDADES FUERTES
DESCRIBE SOCIO;

INSERT ALL
INTO SOCIO (NOMBRE, DIRECCION, TELEFONO)  VALUES ('AYLIN','XALAPA','2282330908')
INTO SOCIO (NOMBRE, DIRECCION, TELEFONO)  VALUES ('ALEX','XALAPA','2281072635')
INTO SOCIO (NOMBRE, DIRECCION, TELEFONO)  VALUES ('ALEJANDRO','CDMX','3023079497')
INTO SOCIO (NOMBRE, DIRECCION, TELEFONO)  VALUES ('EMMANUEL','CDMX','5630345103')
INTO SOCIO (NOMBRE, DIRECCION, TELEFONO)  VALUES ('EDUARDO','MORELIA','4438443145')
SELECT * FROM DUAL;

SELECT * FROM SOCIO;

INSERT ALL
INTO PATRON (NOMBRE, DIRECCION, TELEFONO)  VALUES ('ABDIEL','XALAPA','2282535827')
INTO PATRON (NOMBRE, DIRECCION, TELEFONO)  VALUES ('MARCOS','XALAPA','2283054341')
INTO PATRON (NOMBRE, DIRECCION, TELEFONO)  VALUES ('TAVO','ACAPULCO','7441198412')
INTO PATRON (NOMBRE, DIRECCION, TELEFONO)  VALUES ('AARON','XALAPA','2283443722')
INTO PATRON (NOMBRE, DIRECCION, TELEFONO)  VALUES ('CESAR','ACAPULCO','7443838589')
SELECT * FROM DUAL;

SELECT * FROM PATRON;

DESCRIBE BARCO;
INSERT ALL
INTO BARCO (NOMBRE, NUM_AMARRE, CUOTA) VALUES ('LA NI?A', 11, 800.50)
INTO BARCO (NOMBRE, NUM_AMARRE, CUOTA) VALUES ('LA PINTA', 12, 900.50)
INTO BARCO (NOMBRE, NUM_AMARRE, CUOTA) VALUES ('ST. MARIE', 13, 1000.50)
INTO BARCO (NOMBRE, NUM_AMARRE, CUOTA) VALUES ('MINI TITANIC', 14, 2000.50)
INTO BARCO (NOMBRE, NUM_AMARRE, CUOTA) VALUES ('POSEIDON', 15, 5000.50)
SELECT * FROM DUAL;

SELECT * FROM BARCO;

DESCRIBE SOCIOS_BARCO;

INSERT ALL
INTO SOCIOS_BARCO (ID_SOCIO,ID_BARCO) VALUES (1,1)
INTO SOCIOS_BARCO (ID_SOCIO,ID_BARCO) VALUES (2,2)
INTO SOCIOS_BARCO (ID_SOCIO,ID_BARCO) VALUES (3,3)
INTO SOCIOS_BARCO (ID_SOCIO,ID_BARCO) VALUES (4,4)
INTO SOCIOS_BARCO (ID_SOCIO,ID_BARCO) VALUES (5,5)
SELECT * FROM DUAL;

SELECT * FROM SOCIOS_BARCO;

DESCRIBE SALIDAS_BARCO;

INSERT ALL
INTO SALIDAS_BARCO (DESTINO,FECHASALIDA,ID_BARCO,ID_PATRON) 
VALUES ('VERACRUZ',TO_DATE('20/01/2023 01:30:00','DD-MM-YYYY HH24:MI:SS'),1,1)
INTO SALIDAS_BARCO (DESTINO,FECHASALIDA,ID_BARCO,ID_PATRON) 
VALUES ('VILLAHERMOSA',TO_DATE('21/01/2023 13:30:00','DD-MM-YYYY HH24:MI:SS'),1,1)
INTO SALIDAS_BARCO (DESTINO,FECHASALIDA,ID_BARCO,ID_PATRON) 
VALUES ('CAMPECHE',TO_DATE('22/01/2023 14:30:00','DD-MM-YYYY HH24:MI:SS'),1,1)
INTO SALIDAS_BARCO (DESTINO,FECHASALIDA,ID_BARCO,ID_PATRON) 
VALUES ('YUCATAN',TO_DATE('23/01/2023 15:30:00','DD-MM-YYYY HH24:MI:SS'),1,1)
INTO SALIDAS_BARCO (DESTINO,FECHASALIDA,ID_BARCO,ID_PATRON) 
VALUES ('CANCUN',TO_DATE('24/01/2023 16:30:00','DD-MM-YYYY HH24:MI:SS'),1,1)
SELECT * FROM DUAL;

INSERT INTO SALIDAS_BARCO (DESTINO,FECHASALIDA,ID_BARCO,ID_PATRON) 
VALUES ('COZUMEL',TO_DATE('25/01/2023 12:00:00','DD-MM-YYYY HH24:MI:SS'),1,1);

SELECT * FROM SALIDAS_BARCO;

-- CONSULTAR HORARIO Y FECHA
SELECT ID_SALIDA, DESTINO, TO_CHAR (FECHASALIDA, 'DD-MM-YYYY HH24:MI:SS') FROM SALIDAS_BARCO;

-- CONSULTA DE UNICAMENTE EL HORARIO

SELECT ID_SALIDA, DESTINO, TO_CHAR(FECHASALIDA, 'HH24:MI:SS') FROM SALIDAS_BARCO;

COMMIT;

----------------------------------------------------------
-- EJERCICIO AEROLINEA

--CREANDO ENTIDADES FUERTES

CREATE TABLE BASES(
ID_BASE NUMBER PRIMARY KEY,
TIPO NVARCHAR2(20)
);
-- CREAMOS LA SECUENCIA PARA LA TABLA DE BASES
CREATE SEQUENCE BASES_SEQ;
--CREAMOS EL DISPARADOR PARA LA TABLA BASES
CREATE TRIGGER INSERT_BASES
BEFORE INSERT ON BASES FOR EACH ROW BEGIN
SELECT BASES_SEQ.NEXTVAL INTO:NEW.ID_BASE FROM DUAL;
END;

--CREAMOS LA ENTIDAD DE CLIENTES
CREATE TABLE CLIENTES_VUELO(
ID_CLIENTE NUMBER PRIMARY KEY,
NOMBRE NVARCHAR2 (30),
DIRECCION NVARCHAR2(30),
TELEFONO NVARCHAR2(10),
EMAIL NVARCHAR2(30)
);

CREATE SEQUENCE CLIENTESS_SEQ;

CREATE TRIGGER INSERT_CLIENTESS
BEFORE INSERT ON CLIENTES_VUELO FOR EACH ROW BEGIN
SELECT CLIENTESS_SEQ.NEXTVAL INTO:NEW.ID_CLIENTE FROM DUAL;
END;

-- CREANDO ENTIDADES DEBILES

CREATE TABLE PILOTOS(
ID_PILOTO NUMBER PRIMARY KEY,
NOMBRE NVARCHAR2(30),
HORASVUELO NUMBER,
ID_BASE NUMBER,
CONSTRAINT FK_IDBASE_PILOTOS
FOREIGN KEY (ID_BASE)
REFERENCES BASES (ID_BASE),
CONSTRAINT CHECK_BASE_PILOTOS CHECK (ID_BASE IN (1))
);

CREATE SEQUENCE PILOTOS_SEQ;

CREATE TRIGGER INSERT_PILOTOS
BEFORE INSERT ON PILOTOS FOR EACH ROW BEGIN
SELECT PILOTOS_SEQ.NEXTVAL INTO:NEW.ID_PILOTO FROM DUAL;
END;
---------------------------------------------
CREATE TABLE TRIPULACION(
ID_TRIPULACION NUMBER PRIMARY KEY,
NOMBRE NVARCHAR2(30),
ID_BASE NUMBER,
CONSTRAINT FK_IDBASE_TRIPULACION
FOREIGN KEY (ID_BASE)
REFERENCES BASES (ID_BASE),
CONSTRAINT CHECK_BASE_TRIPULACION CHECK (ID_BASE IN (1))
);

CREATE SEQUENCE TRIPULACION_SEQ;

CREATE TRIGGER INSERT_TRIPULACION
BEFORE INSERT ON TRIPULACION FOR EACH ROW BEGIN
SELECT TRIPULACION_SEQ.NEXTVAL INTO:NEW.ID_TRIPULACION FROM DUAL;
END;

-----------------------------------------------------
CREATE TABLE AVIONES(
ID_AVION NUMBER PRIMARY KEY,
MODELO NVARCHAR2(30),
ID_BASE NUMBER,
CONSTRAINT FK_IDBASE_AVIONES
FOREIGN KEY (ID_BASE)
REFERENCES BASES (ID_BASE),
CONSTRAINT CHECK_BASE_AVIONES CHECK (ID_BASE IN (2))
);

CREATE SEQUENCE AVIONES_SEQ;

CREATE TRIGGER INSERT_AVIONES
BEFORE INSERT ON AVIONES FOR EACH ROW BEGIN
SELECT AVIONES_SEQ.NEXTVAL INTO:NEW.ID_AVION FROM DUAL;
END;

-- VER HORA Y FECHA COMO LA TENEMOS EN SISTEMA
SELECT SYSDATE FROM DUAL;

------------------------------------------------
CREATE TABLE VUELOS(
ID_VUELO NUMBER PRIMARY KEY,
ORIGEN NVARCHAR2(30),
DESTINO NVARCHAR2(30),
HORAFECHA DATE,
ID_PILOTO NUMBER,
ID_AVION NUMBER,
CONSTRAINT FK_IDPILOTO_VUELOS
FOREIGN KEY (ID_PILOTO)
REFERENCES PILOTOS (ID_PILOTO),
CONSTRAINT FK_IDAVION_VUELOS
FOREIGN KEY (ID_AVION)
REFERENCES AVIONES (ID_AVION)
);

CREATE SEQUENCE VUELOS_SEQ;

CREATE TRIGGER INSERT_VUELOS
BEFORE INSERT ON VUELOS FOR EACH ROW BEGIN
SELECT VUELOS_SEQ.NEXTVAL INTO:NEW.ID_VUELO FROM DUAL;
END;

--------------------------------
CREATE TABLE TRIPULACION_VUELO(
ID_TV NUMBER PRIMARY KEY,
ID_TRIPULACION NUMBER,
ID_VUELO NUMBER,
CONSTRAINT FK_IDTRIPULACION_TV 
FOREIGN KEY (ID_TRIPULACION)
REFERENCES TRIPULACION (ID_TRIPULACION),
CONSTRAINT FK_IDVUELO_TV 
FOREIGN KEY (ID_VUELO)
REFERENCES VUELOS (ID_VUELO)
);

CREATE SEQUENCE TV_SEQ;

CREATE TRIGGER INSERT_TV
BEFORE INSERT ON TRIPULACION_VUELO FOR EACH ROW BEGIN
SELECT TV_SEQ.NEXTVAL INTO:NEW.ID_TV FROM DUAL;
END;
------------------------------------------------
CREATE TABLE BOLETOS(
ID_BOLETO NUMBER PRIMARY KEY,
ID_VUELO NUMBER,
ID_CLIENTE NUMBER,
COSTO NUMBER (8,2),
CONSTRAINT FK_IDVUELO_BOLETOS 
FOREIGN KEY (ID_VUELO)
REFERENCES VUELOS (ID_VUELO),
CONSTRAINT FK_IDCLIENTE_BOLETOS 
FOREIGN KEY (ID_CLIENTE)
REFERENCES CLIENTES_VUELO (ID_CLIENTE)
);

CREATE SEQUENCE BOLETOS_SEQ;

CREATE TRIGGER INSERT_BOLETOS
BEFORE INSERT ON BOLETOS FOR EACH ROW BEGIN
SELECT BOLETOS_SEQ.NEXTVAL INTO:NEW.ID_BOLETO FROM DUAL;
END;
-------------------------------------------------------------------
--INSERCIONES DE REGISTROS, COMENZANDO POR LAS ENTIDADES FUERTES

-- INSERCION DE REGISTROS DE BASES
INSERT INTO BASES (ID_BASE,TIPO) VALUES (1,'DESCANSO');
INSERT INTO BASES (ID_BASE,TIPO) VALUES (2,'MANTENIMIENTO');

SELECT * FROM BASES;

-- INSERCIÃ“N DE REGISTROS DE CLIENTES
DESCRIBE CLIENTES_VUELO;

INSERT ALL
INTO CLIENTES_VUELO (NOMBRE,DIRECCION,TELEFONO,EMAIL) VALUES
('MARIO','ZACATECAS','5567907654','mario@gmail.com')
INTO CLIENTES_VUELO (NOMBRE,DIRECCION,TELEFONO,EMAIL) VALUES
('JOSE ZAHID','EDOMEX','5567901354','josez@gmail.com')
INTO CLIENTES_VUELO (NOMBRE,DIRECCION,TELEFONO,EMAIL) VALUES
('GABRIELA','VERACRUZ','2287907654','gaby@gmail.com')
INTO CLIENTES_VUELO (NOMBRE,DIRECCION,TELEFONO,EMAIL) VALUES
('AARON','PUEBLA','2227907654','aaron@gmail.com')
INTO CLIENTES_VUELO (NOMBRE,DIRECCION,TELEFONO,EMAIL) VALUES
('LUIS','MICHOACAN','4467907654','luis@gmail.com')
SELECT * FROM DUAL;

SELECT * FROM CLIENTES_VUELO;

-- INSERCION DE REGISTROS DE PILOTOS
DESCRIBE PILOTOS;

INSERT ALL 
INTO PILOTOS (NOMBRE,HORASVUELO,ID_BASE) VALUES
('GERARDO',1200,1)
INTO PILOTOS (NOMBRE,HORASVUELO,ID_BASE) VALUES
('CESAR',700,1)
INTO PILOTOS (NOMBRE,HORASVUELO,ID_BASE) VALUES
('PEDRO',450,1)
INTO PILOTOS (NOMBRE,HORASVUELO,ID_BASE) VALUES
('JUAN',1400,1)
INTO PILOTOS (NOMBRE,HORASVUELO,ID_BASE) VALUES
('GUSTAVO',300,1)
SELECT * FROM DUAL;

INSERT INTO PILOTOS (NOMBRE,HORASVUELO,ID_BASE) VALUES ('EVANGELINO',800,1);

SELECT * FROM PILOTOS;

-- ACTUALIZAR UN REGISTRO INDIVIDUAL
UPDATE PILOTOS SET NOMBRE = 'ALBERTANO' WHERE ID_PILOTO=8;
UPDATE PILOTOS SET HORASVUELO = 1500 WHERE ID_PILOTO=8;

-- INSERCION DE DATOS EN LA TABLA DE TRIPULACION

DESCRIBE TRIPULACION;

INSERT ALL 
INTO TRIPULACION (NOMBRE, ID_BASE) VALUES ('EDUARDO',1)
INTO TRIPULACION (NOMBRE, ID_BASE) VALUES ('CAROLINA',1)
INTO TRIPULACION (NOMBRE, ID_BASE) VALUES ('STEPHANY',1)
INTO TRIPULACION (NOMBRE, ID_BASE) VALUES ('JUAN',1)
INTO TRIPULACION (NOMBRE, ID_BASE) VALUES ('ANDRES',1)
SELECT * FROM DUAL;

SELECT * FROM TRIPULACION;

-- INSERCIÃ“N DE REGISTROS DE AVIONES
DESCRIBE AVIONES;

INSERT ALL
INTO AVIONES (MODELO, ID_BASE) VALUES ('BOEING-1900',2)
INTO AVIONES (MODELO, ID_BASE) VALUES ('AIRBUS-900',2)
INTO AVIONES (MODELO, ID_BASE) VALUES ('BOEING-3900',2)
INTO AVIONES (MODELO, ID_BASE) VALUES ('BOEING-2900',2)
INTO AVIONES (MODELO, ID_BASE) VALUES ('PELICAN-2300',2)
SELECT * FROM DUAL;

SELECT * FROM AVIONES;

-- CONFIRMAMOS CAMBIOS EN LOS REGISTROS
COMMIT;

-- INSERCIÃ“N DE REGISTROS EN VUELOS
DESCRIBE VUELOS;
INSERT ALL
INTO VUELOS (ORIGEN, DESTINO, HORAFECHA, ID_PILOTO, ID_AVION) VALUES
('VIENNA','TOKYO', TO_DATE('2/03/2023 14:30:00', 'DD-MM-YYYY HH24:MI:SS'),1,2)
INTO VUELOS (ORIGEN, DESTINO, HORAFECHA, ID_PILOTO, ID_AVION) VALUES
('PARIS','EGIPTO', TO_DATE('3/03/2023 17:30:00', 'DD-MM-YYYY HH24:MI:SS'),2,3)
INTO VUELOS (ORIGEN, DESTINO, HORAFECHA, ID_PILOTO, ID_AVION) VALUES
('TIJUANA','ACAPULCO', TO_DATE('4/03/2023 12:00:00', 'DD-MM-YYYY HH24:MI:SS'),4,1)
INTO VUELOS (ORIGEN, DESTINO, HORAFECHA, ID_PILOTO, ID_AVION) VALUES
('CDMX','MOSCU', TO_DATE('5/03/2023 18:10:00', 'DD-MM-YYYY HH24:MI:SS'),3,5)
INTO VUELOS (ORIGEN, DESTINO, HORAFECHA, ID_PILOTO, ID_AVION) VALUES
('BERLÃ?N','ROMA', TO_DATE('6/03/2023 15:50:00', 'DD-MM-YYYY HH24:MI:SS'),5,5)
SELECT * FROM DUAL;

SELECT * FROM VUELOS;

-- INSERCION DE REGISTROS DE TRIPULACION_VUELO

DESCRIBE TRIPULACION_VUELO;

INSERT ALL
INTO TRIPULACION_VUELO (ID_TRIPULACION,ID_VUELO) VALUES (1,5)
INTO TRIPULACION_VUELO (ID_TRIPULACION,ID_VUELO) VALUES (2,3)
INTO TRIPULACION_VUELO (ID_TRIPULACION,ID_VUELO) VALUES (3,1)
INTO TRIPULACION_VUELO (ID_TRIPULACION,ID_VUELO) VALUES (4,4)
INTO TRIPULACION_VUELO (ID_TRIPULACION,ID_VUELO) VALUES (5,2)
SELECT * FROM DUAL;

SELECT * FROM TRIPULACION_VUELO;

-- INSERCIÃ“N DE REGISTROS DE BOLETOS
DESCRIBE BOLETOS;

INSERT ALL 
INTO BOLETOS (ID_VUELO,ID_CLIENTE,COSTO) VALUES (1,2,25000.00)
INTO BOLETOS (ID_VUELO,ID_CLIENTE,COSTO) VALUES (3,4,5000.00)
INTO BOLETOS (ID_VUELO,ID_CLIENTE,COSTO) VALUES (5,1,35000.00)
INTO BOLETOS (ID_VUELO,ID_CLIENTE,COSTO) VALUES (2,5,50000.00)
INTO BOLETOS (ID_VUELO,ID_CLIENTE,COSTO) VALUES (4,3,125000.00)
SELECT * FROM DUAL;

UPDATE BOLETOS SET COSTO = 80000.88 WHERE ID_BOLETO=5;

-- BORRAR UNA RESTRICCION EN UNA TABLA
alter table TABLA
  drop constraint NOMBRERESTRICCION;

SELECT * FROM BOLETOS;

COMMIT;

INSERT INTO TRIPULACION (NOMBRE, ID_BASE) VALUES ('MANUEL',1);
SELECT * FROM TRIPULACION;
COMMIT;
-- REVERTIR LA INSERCION DE DATOS, ACTUALIZACION O BORRADO DE DATOS.
-- NOS LLEVA AL ESTADO DEL ULTIMO COMMIT
ROLLBACK;

DELETE FROM TRIPULACION WHERE ID_TRIPULACION=10;

-- BORRAR UN REGISTRO HACIENDOLO COINCIDIR CON OTRO CAMPO
DELETE FROM TRIPULACION WHERE NOMBRE='MANUEL';

-- CONSULTA DE TODOS LOS DATOS DE UNA TABLA
SELECT * FROM NOMBREDELATABLA;

SELECT * FROM PILOTOS;

COMMIT;

-- REALIZAR UNA CONSULTA CON COLUMNAS ESPECIFICAS DE UNA TABLA
SELECT NOMBRE, ID_PILOTO FROM PILOTOS;

-- CONSULTAR DATOS CON UNA DETERMINADA CONDICION
SELECT NOMBRE, HORASVUELO FROM PILOTOS WHERE HORASVUELO>700;

-- CONSULTAR DATOS CON MÃ?S DE UNA CONDICION CONCATENANDOLO CON "AND"
SELECT NOMBRE, HORASVUELO FROM PILOTOS WHERE HORASVUELO<700 AND NOMBRE='GUSTAVO';

-- CONSULTAR DATOS PARA BUSCAR RANGOS MEDIANTE "BETWEEN"
SELECT * FROM PILOTOS WHERE HORASVUELO BETWEEN 400 AND 1200;

-- CONSULTADO VALORES SIMILARES (NOMBRE)
SELECT * FROM PILOTOS WHERE NOMBRE LIKE 'P%';
SELECT * FROM PILOTOS WHERE NOMBRE LIKE '%O';

--FUNCIONES DE AGREGACIÃ“N
SELECT MAX(HORASVUELO) FROM PILOTOS;
SELECT MIN(HORASVUELO) FROM PILOTOS;

-- BUSCAR AL PILOTO CON MÃ?S HORAS DE VUELO
SELECT * FROM PILOTOS WHERE HORASVUELO = (SELECT MAX (HORASVUELO) FROM PILOTOS);

COMMIT;

-- ESTABLECER UNA COLUMNA CON VALORES NULOS
UPDATE PILOTOS SET HORASVUELO=NULL; -- Actualizar los valores a nulos
SELECT * FROM PILOTOS; -- Consultamos que los cambios se hayan realizado
ROLLBACK;

-- REALIZAR UN CONTEO DE LAS FILAS O REGISTROS PARA DETERMINADOS DATOS
-- NOS RETORNA EL VALOR DE CUANTOS REGISTROS CUMPLEN UNA DETERMINADA CONDICION
SELECT COUNT (ID_PILOTO) FROM PILOTOS WHERE HORASVUELO>700;

-- OBTENER EL PROMEDIO DE LOS VALORES DE UNA COLUMNA
SELECT AVG (HORASVUELO) FROM PILOTOS;

-- SUMATORIA DE LOS VALORES DE UNA COLUMNA
SELECT SUM (HORASVUELO) FROM PILOTOS;

-- FUNCIONES GROUP BY
-- MOSTRAR CUANTOS ALUMNOS HAY POR CADA GENERO
SELECT COUNT (ID_ALUMNO), SEXO FROM ALUMNO GROUP BY SEXO;

SELECT * FROM ALUMNO;

-- ORDENAR REGISTROS PARA MOSTRARLOS EN ORDEN DESCENDENTE
SELECT * FROM ALUMNO ORDER BY NOMBRE DESC;

-- ORDENAR REGISTROS PARA MOSTRARLOS EN ORDEN ASCENDENTE
SELECT * FROM ALUMNO ORDER BY NOMBRE ASC;

---------------------------------------------------------
-- REALIZAR LA SIGUIENTE CONSULTA
--BUSCAR LOS DATOS DE LA TRIPULACION QUE ESTUVO CON DETERMINADO CLIENTE
-- EN UN VUELO Y DONDE EL NOMBRE DEL CLIENTE HAYA SIDO - 'NOMBRE

SELECT * FROM CLIENTES_VUELO;
SELECT * FROM BOLETOS;
SELECT * FROM TRIPULACION_VUELO;

SELECT * FROM TRIPULACION WHERE ID_TRIPULACION=
SELECT ID_TRIPULACION FROM TRIPULACION_VUELO WHERE ID_VUELO=
SELECT ID_VUELO FROM BOLETOS WHERE ID_CLIENTE=3; --En la tabla de boletos identificamos el vuelo de boletos
SELECT ID_CLIENTE FROM CLIENTES_VUELO WHERE ID_NOMBRE='AARON')));


SELECT * FROM TRIPULACION
WHERE ID_TRIPULACION=(SELECT ID_TRIPULACION FROM TRIPULACION_VUELO 
WHERE ID_VUELO=(SELECT ID_VUELO FROM BOLETOS WHERE ID_CLIENTE=(
SELECT ID_CLIENTE FROM CLIENTES_VUELO WHERE ID_CLIENTE='4')));


------------------------------------------------------------------------
-- Ivestigar los conceptos de INNER JOIN, LEFT JOIN, RIGHT JOIN

-- consultas con joins
-- INNER JOIN
-- SE MUESTRAB LOS REEGISTROS QUE COINCEDEN DE UNA TABLA 'A'A Y UNA TABLA 'B'
-- LA COINCIDENCIA DE AMBAS SE MUESTRAN JUSTO EN EL MEDIO DEL CAMPO QUE LOS UNE (LLAVE)
-- TODO ESTO SE LOGRA GRACIAS AL USO DE VALORES COMPARTIDOS (PRIMARY KEY FOREING KEY)
-- FORMA EXPLICITA
-- INDICAMOS EL USO DE INNER JOIN O JOIN

SELECT * FROM  PILOTOS -- SELECCIONAR UNA TABLA 'A'
INNER JOIN BASES -- INDICAMOS LA UNION A UNA TABLA 'B' MEDIANTE INNER JOIN
ON PILOTOS.ID_BASE=BASES.ID_BASE;
-- INDICAMOS EN DONDE SE UNEN (DATO COMUN) CON EL NOMBRE DE LA TABLA Y SU COLUMNA

SELECT * FROM  PILOTOS 
JOIN BASES 
ON PILOTOS.ID_BASE=BASES.ID_BASE;

-- PODEMOS CREAR ALIAS DE LAS TABLAS PARA EVITAR ESCRIBIR EL NOMBRE COMPLETO

SELECT * FROM PILOTOS P
INNER JOIN BASES B
ON p.ID_BASE=b.id_base;

-- forma implicita 
-- OMITIMOS LA INSTRUCCION INNER JOIN Y ON, Y SE SUSTITUYR POR WHERE
SELECT * FROM PILOTOS,BASES
WHERE PILOTOS.ID_BASE=BASES.ID_BASE;

-- LEFT JOIN 
-- SE MUESTRAN O PRIORIZAN LOS DATOS O ELEMENTOS DE LA PRIMERA TABLA
-- Y SE MUESTRAN LOS COINCIDENTES CON LA SEGUNDA TABLA

SELECT NOMBRE FROM BASES
LEFT JOIN PILOTOS
ON pilotos.id_base=bases.id_base;

-- FUÑ


-- BUSCAR LOS DATOS DE LA TRIPULACION QUE ESTUVO CON DETERMINADO CLIENTE
-- EN UN VUELO Y DONDE EL NOMBRE DEL CLIENTE HAYA SIDO = 'NOMBRE'
-- RESOLVERLO CON JOINS

SELECT * FROM CLIENTES_VUELO; 
SELECT * FROM TRIPULACION;

SELECT T.ID_TRIPULACION,T.NOMBRE,T.ID_BASE FROM TRIPULACION T 
INNER JOIN BOLETOS
ON BOLETOSID_BASE=b.id_base;



SELECT T.ID_TRIPULACION,T.NOMBRE,T.ID_BASE FROM TRIPULACION T
INNER JOIN TRIPULACION_VUELO TV
ON t.id_tripulacion=tv.id_tripulacion
INNER JOIN BOLETOS B
ON b.id_vuelo=tv.id_vuelo
INNER JOIN CLIENTES_VUELO CV
ON cv.id_cliente=b.id_cliente
WHERE cv.nombre='AARON';

SELECT * FROM TRIPULACION T
INNER JOIN TRIPULACION_VUELO TV
ON t.id_tripulacion=tv.id_tripulacion
INNER JOIN BOLETOS B
ON b.id_vuelo=tv.id_vuelo
INNER JOIN CLIENTES_VUELO CV
ON cv.id_cliente=b.id_cliente
WHERE cv.nombre='AARON';

WHERE ID_TRIPULACION=(SELECT ID_TRIPULACION FROM TRIPULACION_VUELO 
WHERE ID_VUELO=(SELECT ID_VUELO FROM BOLETOS WHERE ID_CLIENTE=(
SELECT ID_CLIENTE FROM CLIENTES_VUELO WHERE ID_CLIENTE='4')));


------------------------------------------------
-- REALIZAR LA SIGUIENTE CONSULTA
-- BUSCAR EL ID DEL AVION MODELO DESTINO DEL VUELO,DEL PILOTO CON MAS HORAS DE VUELO}
-- RESOLVER CON JOIN

SELECT * FROM AVIONES;
SELECT * FROM DESTINO;
SELECT * FROM PILOTOS;

SELECT * FROM TRIPULACION T
INNER JOIN TRIPULACION_VUELO TV
ON t.id_tripulacion=tv.id_tripulacion
INNER JOIN BOLETOS B
ON b.id_vuelo=tv.id_vuelo
INNER JOIN CLIENTES_VUELO CV
ON cv.id_cliente=b.id_cliente
WHERE cv.nombre='AARON';

SELECT A.ID_AVION, A.MODELO, V.DESTINO FROM AVIONES A
INNER JOIN VUELOS V
ON a.id_avion = v.id_avion


SELECT * FROM PILOTOS
INNER JOIN VUELOS
ON vuelos.id_piloto=pilotos.id_piloto;

SELECT * FROM PILOTOS
INNER JOIN VUELOS
ON vuelos.id_piloto=pilotos.id_piloto
INNER JOIN AVIONES
ON AVIONES.ID_AVION=vuelos.id_avion

SELECT * FROM PILOTOS
INNER JOIN VUELOS
ON vuelos.id_piloto=pilotos.id_piloto
INNER JOIN AVIONES
ON AVIONES.ID_AVION=vuelos.id_avion
WHERE PILOTOS.HORASVUELO=(SELECT MIN(HORASVUELO) FROM PILOTOS)

SELECT AVIONES.ID_AVION,AVIONES.MODELO,VUELOS.DESTINO FROM PILOTOS
INNER JOIN VUELOS
ON vuelos.id_piloto=pilotos.id_piloto
INNER JOIN AVIONES
ON AVIONES.ID_AVION=vuelos.id_avion
WHERE PILOTOS.HORASVUELO=(SELECT MIN(HORASVUELO) FROM PILOTOS);

--



























